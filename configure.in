AC_INIT(sqlfs.c)


AC_CANONICAL_HOST
AC_CANONICAL_TARGET
AC_CONFIG_AUX_DIR([.])
AC_CONFIG_MACRO_DIR([m4])

AM_INIT_AUTOMAKE(libsqlfs, 1.1)

AC_PROG_CC
AC_PROG_LIBTOOL

AC_DEFINE(_GNU_SOURCE, 1)

AC_CHECK_LIB(sqlcipher, sqlite3_key, [sqlcipher=yes])
AC_CHECK_LIB(sqlite3, sqlite3_db_filename, [sqlite=yes])

if test "$sqlcipher" = "yes"; then
    echo "Using libsqlcipher"
    LIBS="$LIBS -lsqlcipher"
elif test "$sqlite" = "yes"; then
    echo "Using libsqlite3"
    LIBS="$LIBS -lsqlite3"
else
    echo "Error! SQLCipher or SQLite3 is required!"
    exit -1
fi

AC_SYS_LARGEFILE

AC_CHECK_HEADER(fuse.h, [fuse=yes], [fuse=no])
AM_CONDITIONAL(FUSE, test x$fuse = xyes)

AC_CHECK_HEADERS([sys/statvfs.h])

AC_CONFIG_FILES(Makefile tests/Makefile libsqlfs.pc)

AC_OUTPUT





